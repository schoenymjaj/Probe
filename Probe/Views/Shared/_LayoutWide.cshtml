<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - In Common</title>


    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")

    <link href="@Url.Content("~/Content/themes/base/jquery.ui.core.css")"
          rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/themes/base/jquery.ui.theme.css")"
          rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/themes/custom-accordian/jquery-ui-1.10.4.custom.min.css")"
          rel="stylesheet" type="text/css" />

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")

    <script src="@Url.Content("~/Scripts/jquery-ui-1.10.4.js")"
            type="text/javascript"></script>
    @*<script src="@Url.Content("~/Scripts/DatePickerReady.js")"
    type="text/javascript"></script> //Report pages/w Google Chart get javascript error*@
    <script src="@Url.Content("~/Scripts/spin.min.js")"
            type="text/javascript"></script>

    <script src="@Url.Content("~/Scripts/probe/probe-helpers.js")"
            type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/probe/probe-reportchart-helpers.js")"
            type="text/javascript"></script>

    <script type="text/javascript">
        var logErrorUrl = '@Url.Action("LogJavaScriptError", "Error")';
    </script>
    <script src="@Url.Content("~/Scripts/probe/stacktrace.js")" type="text/javascript"></script>


	<link href="@Url.Content("~/Content/kendo/2015.2.624/kendo.common.min.css")" rel="stylesheet" type="text/css" />
	<link href="@Url.Content("~/Content/kendo/2015.2.624/kendo.mobile.all.min.css")" rel="stylesheet" type="text/css" />
	<link href="@Url.Content("~/Content/kendo/2015.2.624/kendo.dataviz.min.css")" rel="stylesheet" type="text/css" />

    <link href="@Url.Content("~/Content/kendo/2015.2.624/kendo.default.min.css")" rel="stylesheet" type="text/css" />
    @*<link href="@Url.Content("~/Content/kendo/2015.2.624/kendo.flat.min.css")" rel="stylesheet" type="text/css" />*@

	<link href="@Url.Content("~/Content/kendo/2015.2.624/kendo.dataviz.default.min.css")" rel="stylesheet" type="text/css" />
	<!--<script src="@Url.Content("~/Scripts/kendo/2015.2.624/jquery.min.js")"></script>-->
	<script src="@Url.Content("~/Scripts/kendo/2015.2.624/jszip.min.js")"></script>
	<script src="@Url.Content("~/Scripts/kendo/2015.2.624/kendo.all.min.js")"></script>
	<script src="@Url.Content("~/Scripts/kendo/2015.2.624/kendo.aspnetmvc.min.js")"></script>
	<script src="@Url.Content("~/Scripts/kendo.modernizr.custom.js")"></script>

    <style>
        /*
            THESE BODY CONTAINER WIDTH OVERRIDES ARE WHAT DISTINGUISH
            THIS VERSION OF THE DEFAULT LAYOUT WHICH IS THE WIDE DEFAULT LAYOUT
            ALLOWS CONTENT TO BE PROPORTIONAL TO THE WIDTH OF THE WINDOW. AND WIDER

        */
        @@media (min-width: 768px) {
            .container {
                width: 750px;
            }
        }

        @@media (min-width: 892px) {
            .container {
                width: 877px;
            }
        }

        @@media (min-width: 992px) {
            .container {
                width: 970px;
            }
        }

        @@media (min-width: 1100px) {
            .container {
                width: 1078px;
            }
        }

        @@media (min-width: 1200px) {
            .container {
                width: 1170px;
            }
        }

        @@media (min-width: 1400px) {
            .container {
                width: 1370px;
            }
        }

        @@media (min-width: 1500px) {
            .container {
                width: 1470px;
            }
        }
        @@media (min-width: 1600px) {
            .container {
                width: 1570px;
            }
        }
    </style>


</head>
<body class="backimageInCommon backCoverInCommon">

    @functions{
        public bool IsUserLoggedIn()
        {
            bool returnStatus = System.Web.HttpContext.Current.User.Identity.IsAuthenticated;

            return returnStatus;
        }

        public bool IsUserInRole(string roleName)
        {

            bool returnStatus = false;

            try
            {
                if (System.Web.HttpContext.Current.User.Identity.IsAuthenticated)
                {
                    Probe.Models.ApplicationDbContext dbIdentity = new Probe.Models.ApplicationDbContext();
                    string userName = System.Web.HttpContext.Current.User.Identity.Name;
                    Probe.Models.ApplicationUser user = dbIdentity.Users.Where(u => u.UserName == userName).Single();
                    var role = dbIdentity.Roles.Where(r => r.Name == roleName).Single();

                    returnStatus = user.Roles.Where(r => r.RoleId == role.Id).Count() > 0;

                }

            }
            catch
            {
                returnStatus = false; //if there is an issue; we will just not give the user access
            }

            return returnStatus;
        }



        public string GetControllerName()
        {
            return HttpContext.Current.Request.RequestContext.RouteData.Values["Controller"].ToString();
        }
    }


    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                @Html.ActionLink("In Common", "Index", "Home",null, new { @class = "navbar-brand" })
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    @if (!IsUserLoggedIn()) {
                        <li>@Html.ActionLink("Home","Index", "Home")</li>
                    }
                    @if (IsUserInRole("Admin"))
                    {
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Game<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li class="dropdown-submenu">
                                    <a tabindex="-1" href="#">Game Configuration</a>
                                    <ul class="dropdown-menu">
                                        <li>
                                            @Html.ActionLink("Game Type Setup", "Index", "GameTypes")
                                            @Html.ActionLink("Game Admin", "Admin", "Games")
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    @Html.ActionLink("My Games", "Index", "Games")
                                </li>
                            </ul>
                        </li>
                    }
                    else if (IsUserLoggedIn())
                    {
                        <li>@Html.ActionLink("My Games", "Index", "Games")</li>
                    }
                    @if (IsUserInRole("Admin"))
                    {
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Question<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li>
                                    @Html.ActionLink("Question Type Setup", "Index", "QuestionTypes")
                                    @Html.ActionLink("My Question Library", "Index", "ChoiceQuestions")
                                </li>
                            </ul>
                        </li>
                    }
                    else if (IsUserLoggedIn())
                    {
                        <li>@Html.ActionLink("My Question Library", "Index", "ChoiceQuestions")</li>
                    }
                    <li>@Html.ActionLink("About", "About", "Home")</li>
                </ul>
                @Html.Partial("_LoginPartial")
            </div>
        </div>
    </div>

    @if (GetControllerName() != "Reports")
    {
        <div class="container body-content">
            @RenderBody()
            <hr />
            <footer>
                <p>&copy; @DateTime.Now.Year - In Common Social Media Application</p>
            </footer>
        </div>
    }
    else
    {
        <div class="reportContentContainer">
            @RenderBody()
            <hr />
            <footer>
                <p>&copy; @DateTime.Now.Year - In Common Social Media Application</p>
            </footer>
        </div>
    }

    @RenderSection("scripts", required: false)

    <script type="text/javascript">
    $(document).ready(function () {

        var dt = new Date();
        var tzo = dt.getTimezoneOffset();
        document.cookie = "timeZoneOffset=" + tzo + "; path=/";
    });
    </script>
</body>
</html>
