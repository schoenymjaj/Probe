@model IEnumerable<Probe.Models.ChoiceQuestion>

@{
    ViewBag.Title = "Index";
}

<script src="@Url.Content("~/Scripts/probe/probe-setup-tablesorter.js")"
        type="text/javascript"></script>

@functions{
    public bool IsQuestionActive(long? questionId)
    {
        bool status = true;
        if (questionId != null)
        {
            status = ViewBag.DctQuestionActive[(long)questionId];
        }
        else
        {
            status = true;
        }

        return status;
    }
}


<h2>My Question Library</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

<div>
    <table id="questionsTable" class="tablesorter">
        <thead>

            <tr>
                <th>
                    Question Name
                </th>
                <th>
                    Question Text
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.QuestionType.Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.OneChoice)
                </th>
                <th>
                    Choices
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr data-questionid="@item.Id">
                    <td>
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Text)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.QuestionType.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.OneChoice)
                    </td>
                    <td>
                        <a class="choicesDialogLink" data-questionid="@item.Id" href="#">@Html.DisplayFor(modelItem => item.Choices.Count)</a>
                    </td>
                    <td>
                        @Html.ActionLink("Choices", "Index", "Choices", new { SelectedQuestion = item.Id }, null) |
                        @if (!IsQuestionActive(item.Id)) {@Html.ActionLink("Edit", "Edit", new { id = item.Id }) <span>|</span> }
                        @Html.ActionLink("Details", "Details", new { id = item.Id }) 
                        @if (!IsQuestionActive(item.Id)) {<span>|</span> @Html.ActionLink("Delete", "Delete", new { id = item.Id })}
                    </td>
                </tr>

            }
        </tbody>
    </table>
    @Html.Partial("TablesorterPager")
</div>
<div id="dialog-choices" title="Question Choices">
    <div>
        <table id="questionChoicesTable">
            <thead>
                <tr>
                    <th>
                        Choice Name
                    </th>

                    <th>
                        Choice Text
                    </th>

                    <th>
                        Correct
                    </th>
                    <th>
                        Order
                    </th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script type="text/javascript">
    $(function () {

        $("#dialog-choices").hide();

        $('#questionsTable tr').click(function () {

            $('#questionsTable tr').removeClass('selected-row-class');
            $(this).addClass('selected-row-class')

            questionId = $(this).attr('data-questionid');

            //$("#dialog-choices").show();
            //$("#dialog-choices").dialog({
            //    resizable: false,
            //    width: 400,
            //    height: 200,
            //    modal: true,
            //    buttons: {
            //        "Close": function () {
            //            $(this).dialog('close');
            //        }
            //    }
            //});//$("#dialog-choices").dialog({
        });
    }); //$(function () {
</script>



